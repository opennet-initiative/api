<!DOCTYPE html>
<!--
A map visualizing the OpenNet infrastructure on OpenStreetMap.
by Matthias Meißer, released under GPL

Invoke for example via /neighbours.html?ip=192.168.1.205
-->
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>Opennet Karte</title>
	<script type="text/javascript" src="oniMaps.js" charset="utf-8"></script>
	<script type="text/javascript" src="OpenLayers-2.12/OpenLayers_dev.js" ></script><!---DEV version for hint support--->
	<script type="text/javascript" src="OpenStreetMap.js"></script>
	<script type="text/javascript" src="cloudmade.js"></script>
  <script>
	var BASE_URL="/api"
//	var BASE_URL="http://www.opennet-initiative.de/api"
//	var BASE_URL="http://localhost:8080/api" //for local testing environment
	var proj4326
	var projmerc
	var map
	var aps_online, aps_offline, links, links_descr
	var popup,lengthPopup;
	var feature
	var showLabels=false;
	var panel
	//Init
	function init(){
		proj4326 = new OpenLayers.Projection("EPSG:4326");
		projmerc = new OpenLayers.Projection("EPSG:900913");       
		map=initMap(false);
		addBaseLayers();
		ap=getQueryParams().ap;
		if (ap!=null)
		{
			ip=getIPfromAP(ap);
		}
		else
		{
			ip=getQueryParams().ip;
		}
		addOverlays(false,true,false,"/node/neighbours?ip="+ip,"/node/neighbours?ip=="+ip,"/links/neighbours?ip="+ip);
	}
	
	function getIPfromAP(ap)
	{
		ap=ap.toLowerCase();
		ap=ap.replace("ap","");
		if (ap.indexOf(".")>-1)
		{
			ip="192.168."+ap;
		}
		else
		{
			ip="192.168.1."+ap;
		};
		return ip;		
	}

</script>
</head>
<body onload="init();" style="background-color: #B5D0D0">
	<div id="map" style="position:absolute; left:0px; top:0px; width:100%; height:100%"></div>
</body>
</html>
