<!DOCTYPE html>
<!--
A map visualizing the OpenNet infrastructure on OpenStreetMap.
by Matthias MeiÃŸer, released under GPL
-->
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
	<title>Opennet Koordinaten Bestimmung</title>
	<script type="text/javascript" src="OpenLayers-2.12/OpenLayers_dev.js"></script><!---DEV version for hint support--->
	<script type="text/javascript" src="OpenStreetMap.js"></script>
	<script type="text/javascript" src="cloudmade.js"></script>
	<script type="text/javascript" src="oniMaps.js"></script>
	<!--  <script src='http://maps.google.com/maps?file=api&amp;v=2&amp;key=ABQIAAAAttEBvEvohslM2ILNmTwbJxQPKwSEMYVQ3izDaG3Nju_GNCI9nhT7SUbfaHxXJyjkky0KCQwOGRERvA'></script>-->


  <style>.pop_heading{font-family: Arial, Helvetica, sans-serif; font-weight: bold;font-size:16px}</style>
  <style>.pop_text{font-family: Arial, Helvetica, sans-serif;
	font-size: 12px;
	text-decoration: none;
	padding-right:5px;
	padding-top:5px;}
	
	</style>
  <script>	
	var proj4326= new OpenLayers.Projection("EPSG:4326");
	var projmerc= new OpenLayers.Projection("EPSG:900913");  
	var map
	
	//Init
	function init(){
		//add Map
		map = initMap(false);
		addBaseLayers();
		bindClick();
		centerMap();
	}

	function bindClick()
	{
		var click = new OpenLayers.Control.Click();
		map.addControl(click);
        click.activate();
	}
	
OpenLayers.Control.Click = OpenLayers.Class(OpenLayers.Control, {                
                defaultHandlerOptions: {
                    'single': true,
                    'double': false,
                    'pixelTolerance': 0,
                    'stopSingle': false,
                    'stopDouble': false
                },

                initialize: function(options) {
                    this.handlerOptions = OpenLayers.Util.extend(
                        {}, this.defaultHandlerOptions
                    );
                    OpenLayers.Control.prototype.initialize.apply(
                        this, arguments
                    ); 
                    this.handler = new OpenLayers.Handler.Click(
                        this, {
                            'click': this.trigger
                        }, this.handlerOptions
                    );
                }, 

                trigger: function(e) {
                    var lonlat = map.getLonLatFromPixel(e.xy);
                    lonlat=lonlat.transform(projmerc,proj4326);
                    var lat = lonlat.lat.toFixed(6);
                    var lon=lonlat.lon.toFixed(6);
                    document.getElementById('posfield').value="N" +lat+" E" + lon
                }
});
        
</script>
</head>
<body onload="init();">
		<div id="controls" style= "height:30px">
			<small>Ausgabe der Koordinaten: </small><input type="text"  id="posfield"></input>
		</div>
		<div id="map" style="position:absolute; left:0px; top:50px; width:100%; height:100%"></div>
</body>
</html>
